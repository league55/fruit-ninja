{"version":3,"sources":["security/jwt.js","security/tokenManagement.js","api/api.js","timer/timer.js","App.js","reportWebVitals.js","index.js"],"names":["temporaryTestToken","jwt","require","decode","token","task","encoded","getEncodedToken","fetch","method","body","then","r","json","resp","jws","validateToken","sub","console","log","onTokenValid","validateTokenPeriodically","interval","onFail","onPass","intervalId","setInterval","a","result","clearInterval","launchTask","encode","appId","App","useState","setToken","tokenOK","setTokenOK","failReason","setFailReason","className","type","value","onChange","e","target","onClick","decoded","redeemToken","response","reason","src","allow","title","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"qaAAMA,G,OAAqB,oGACrBC,EAAMC,EAAQ,KAOb,SAASC,EAAOC,GACnB,OAAOH,EAAIE,OAAOC,EAAOJ,G,8BCL7B,IAAMK,EAAO,SAACD,GACV,OCYG,SAAuBA,GAC1B,IAAME,EAAUC,EAAgBH,GAChC,OAAOI,MAAM,wCAAyC,CAClDC,OAAQ,OACRC,KAAMJ,IACPK,MAAK,SAAAC,GAAC,OAAIA,EAAEC,UACZF,MAAK,SAAAG,GACF,OAAOX,EAAOW,EAAKC,QDnBlBC,CAAcZ,GAChBO,MAAK,SAAAD,GACF,GAAgB,OAAbA,EAAKO,IAEJ,MADAC,QAAQC,IAAI,8BACNT,EAAKO,QAIrBG,EAAe,kBAAMF,QAAQC,IAAI,yBAExB,SAASE,EAA0BjB,EAAOkB,EAAUC,IEVpD,SAAoBlB,EAAMiB,EAAUE,EAAQD,GACvD,IAAME,EAAaC,YAAW,sBAAC,4BAAAC,EAAA,+EAEJtB,IAFI,OAEnBuB,EAFmB,OAGvBJ,EAAOI,GAHgB,gDAKvBC,cAAcJ,GACdF,EAAO,EAAD,IANiB,yDAQ5BD,GFEHQ,EAAW,kBAAMzB,EAAKD,KAAQkB,EAAUF,EAAcG,GAGnD,SAAShB,EAAgBH,GAC5B,ODhBG,SAAgBA,GACnB,OAAOH,EAAI8B,OAAO3B,EAAOJ,GCelB+B,CAAO,CAACd,IAAKb,EAAO4B,MAAO,gB,WG8BvBC,MA7Cf,WAAgB,IAAD,EACaC,mBAAS,IADtB,mBACN9B,EADM,KACC+B,EADD,OAEiBD,oBAAS,GAF1B,mBAENE,EAFM,KAEGC,EAFH,OAGuBH,mBAAS,IAHhC,mBAGNI,EAHM,KAGMC,EAHN,KAwBb,OACE,sBAAKC,UAAU,MAAf,WACMJ,GACA,qBAAKI,UAAW,YAAhB,SACI,gCACM,2CACA,uBAAOC,KAAK,OAAOC,MAAOtC,EAAOuC,SAVzB,SAACC,GACvBT,EAASS,EAAEC,OAAOH,UAUJ,wBAAQI,QA1B1B,WACE,OFPG,SAAqB1C,GACxB,IAAME,EAAUC,EAAgBH,GAChC,OAAOI,MAAM,sCAAuC,CAChDC,OAAQ,OACRC,KAAMJ,IACPK,MAAK,SAAAC,GAAC,OAAIA,EAAEC,UACVF,MAAK,SAAAG,GACF,IAAIiC,EAAU5C,EAAOW,EAAKC,KAE1B,OADAG,QAAQC,IAAI4B,GACLA,KEFRC,CAAY5C,GAAOO,MAAK,SAAAsC,GACP,OAAjBA,EAAShC,KACRoB,GAAW,GACXE,EAAc,IACdlB,EAA0BjB,EAAQ,KAAM,SAAC8C,GACrCX,EAAcW,GACdb,GAAW,OAGfE,EAAcU,EAAShC,SAgBf,oBACGqB,GAAc,4BAAIA,SAGhCF,GAAW,qBAAKI,UAAW,OAAhB,SACR,wBAAQW,IAAI,8CACJC,MAAM,YACNC,MAAM,eC/BXC,EAZS,SAAAC,GAClBA,GAAeA,aAAuBC,UACxC,8BAAqB7C,MAAK,YAAkD,IAA/C8C,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOF,GACPG,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAQN,OCDdO,IAASC,OACP,cAAC,IAAMC,WAAP,UACE,cAAC,EAAD,MAEFC,SAASC,eAAe,SAM1BZ,M","file":"static/js/main.3ba00bd7.chunk.js","sourcesContent":["const temporaryTestToken = \"qwertyuiopasdfghjklzxcvbnm123456qwertyuiopasdfghjklzxcvbnm123456qwertyuiopasdfghjklzxcvbnm123456\";\nconst jwt = require('jwt-simple');\n\n\nexport function encode(token) {\n    return jwt.encode(token, temporaryTestToken);\n}\n\nexport function decode(token) {\n    return jwt.decode(token, temporaryTestToken);\n}\n","import launchTask from \"../timer/timer\";\nimport {validateToken} from \"../api/api\";\nimport {encode} from \"./jwt\";\n\nconst task = (token) => {\n    return validateToken(token)\n        .then(body => {\n            if(body.sub !== \"OK\") {\n                console.log(\"Token is not valid anymore\");\n                throw body.sub;\n            }\n        });\n}\nconst onTokenValid = () => console.log(\"Token is still valid\");\n\nexport default function validateTokenPeriodically(token, interval, onFail) {\n    launchTask(() => task(token), interval, onTokenValid, onFail);\n}\n\nexport function getEncodedToken(token) {\n    return encode({sub: token, appId: \"fruit-ninja\"});\n}","import {decode} from \"../security/jwt\";\nimport {getEncodedToken} from \"../security/tokenManagement\";\n\n\nexport function redeemToken(token) {\n    const encoded = getEncodedToken(token);\n    return fetch('http://127.0.0.1:5000/tokens/redeem', {\n        method: 'POST',\n        body: encoded\n    }).then(r => r.json())\n        .then(resp => {\n            let decoded = decode(resp.jws);\n            console.log(decoded);\n            return decoded;\n        });\n}\n\nexport function validateToken(token) {\n    const encoded = getEncodedToken(token);\n    return fetch('http://127.0.0.1:5000/tokens/validate', {\n        method: 'POST',\n        body: encoded\n    }).then(r => r.json())\n      .then(resp => {\n          return decode(resp.jws);\n      });\n}","\n/**\n * Launches periodic task that stops itself on exception\n * @param {number} interval - interval to execute a task\n */\nexport default function launchTask(task, interval, onPass, onFail) {\n    const intervalId = setInterval(async () => {\n        try {\n            let result = await task();\n            onPass(result);\n        } catch (e) {\n            clearInterval(intervalId);\n            onFail(e);\n        }\n    }, interval);\n}","import './App.css';\nimport {useState} from \"react\";\nimport {redeemToken} from \"./api/api\";\nimport validateTokenPeriodically from \"./security/tokenManagement\";\n\nfunction App() {\n  const [token, setToken] = useState(\"\");\n  const [tokenOK, setTokenOK] = useState(false);\n  const [failReason, setFailReason] = useState('');\n\n  function handleRedeemToken() {\n    return redeemToken(token).then(response => {\n        if(response.sub === \"OK\") {\n            setTokenOK(true);\n            setFailReason('');\n            validateTokenPeriodically(token,  5000, (reason) => {\n                setFailReason(reason);\n                setTokenOK(false);\n            });\n        } else {\n            setFailReason(response.sub);\n        }\n    });\n  }\n\n  const handleTokenChange = (e) => {\n      setToken(e.target.value);\n  }\n\n  return (\n    <div className=\"App\">\n        {!tokenOK &&\n          <div className={\"licensing\"}>\n              <div>\n                    <span>Token: </span>\n                    <input type=\"text\" value={token} onChange={handleTokenChange}/>\n                    <button onClick={handleRedeemToken}>Submit</button>\n                      {failReason && <p>{failReason}</p>}\n              </div>\n          </div>}\n        {tokenOK && <div className={\"game\"}>\n            <iframe src=\"https://league55.github.io/FruitNinjaClone/\"\n                    allow=\"camera *;\"\n                    title=\"Game\"/>\n        </div>}\n\n    </div>\n  );\n};\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}